"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[966],{1539:(t,e,i)=>{i.d(e,{W:()=>h});var s=i(6649);class h{constructor(t,e,i,h,r){this._private__instantiater=t.instantiater,this._private__gameObjectBuilder=new s.f(t,e,i,h,r)}get instantiater(){return this._private__instantiater}get gameObjectBuilder(){return this._private__gameObjectBuilder}}},9384:(t,e,i)=>{i.d(e,{s:()=>s});class s{constructor(t=null){this.ref=t}}},2182:(t,e,i)=>{i.d(e,{Y:()=>o});var s=i(6120),h=i(4532),r=i(8172),n=i(2684);class o extends r.w{constructor(){super(...arguments),this.disallowMultipleComponent=!0,this.requiredComponents=[n.V],this.mh=null,this.fh=!1,this.uh=1,this.lh=new s.F,this.ph=1,this.Ch=10,this.Vh=5,this.wh=5,this.zh=new h.P,this.xh=t=>{" "===t.key&&(this.wh=this.Vh,this.Sh(),this.transform.localPosition.copy(this.zh))},this.bh=t=>{this.wh+=.01*t.deltaY,this.wh<this.ph?this.wh=this.ph:this.wh>this.Ch&&(this.wh=this.Ch),this.Sh()},this.vr=t=>{this.lh.set(t.clientX/this.engine.screen.width,t.clientY/this.engine.screen.height),t.button===this.uh&&(this.fh=!0)},this.dh=t=>{t.button===this.uh&&(this.fh=!1)},this.gh=t=>{if(!this.fh)return;const e=t.clientX/this.engine.screen.width,i=t.clientY/this.engine.screen.height,s=e-this.lh.x,h=i-this.lh.y,r=this.engine.screen.width/this.engine.screen.height;this.transform.localPosition.x-=s*this.mh.viewSize*2*r,this.transform.localPosition.y+=h*this.mh.viewSize*2,this.lh.set(e,i)},this._h=t=>{this.fh=!1}}awake(){this.mh=this.gameObject.getComponent(n.V),this.Vh=this.mh.viewSize,this.zh.copy(this.transform.localPosition),this.wh=this.Vh,this.mh.viewSize=this.wh}onEnable(){const t=this.engine.input;t.onKeyDown.addListener(this.xh),t.onWheel.addListener(this.bh),t.onPointerDown.addListener(this.vr),t.onPointerUp.addListener(this.dh),t.onPointerMove.addListener(this.gh),t.onPointerLeave.addListener(this._h)}onDisable(){const t=this.engine.input;t.onKeyDown.removeListener(this.xh),t.onWheel.removeListener(this.bh),t.onPointerDown.removeListener(this.vr),t.onPointerUp.removeListener(this.dh),t.onPointerMove.removeListener(this.gh),t.onPointerLeave.removeListener(this._h)}Sh(){this.mh&&(this.mh.viewSize=this.wh)}get minViewSize(){return this.ph}set minViewSize(t){this.ph=t,this.wh<this.ph&&(this.wh=this.ph,this.Sh())}get maxViewSize(){return this.Ch}set maxViewSize(t){this.Ch=t,this.wh>this.Ch&&(this.wh=this.Ch,this.Sh())}get mouseMoveButton(){return this.uh}set mouseMoveButton(t){this.uh=t}}},9067:(t,e,i)=>{i.d(e,{E:()=>s});class s{static loadImageFromPath(t){return new Promise(((e,i)=>{const s=new Image;s.onload=()=>{e(s)},s.onerror=()=>{i(new Error(`Failed to load image "${t}".`))},s.src=t}))}static loadImagesFromPath(t){return Promise.all(t.map((t=>s.loadImageFromPath(t))))}static loadImage(t){return new Promise(((e,i)=>{t.onload=()=>{e(t)},t.onerror=()=>{i(new Error("Failed to load image."))}}))}static loadImages(t){return Promise.all(t.map((t=>s.loadImage(t))))}}},4587:(t,e,i)=>{i.d(e,{d:()=>s});class s{static map(t,e){const i=[];for(let s=0;s<t.length;++s){const h=[],r=t[s];for(let t=0;t<r.length;++t){const i=r[t];if(void 0===e[i])throw new Error(`conversion not found for ${i}`);h.push(e[i](t,s))}i.push(h)}return i}}},70:(t,e,i)=>{i.d(e,{n:()=>c});var s=i(9384),h=i(6120),r=i(4532),n=i(8172),o=i(6324),l=i(4669),a=i(1439);class c extends n.w{constructor(){super(...arguments),this.Fr=new Map,this.Xr=new Map,this.Yr=16,this.Kr=1,this.Nr=1,this.Br=16,this.Gr=16,this.Jr=1.001,this.Qr=null,this.Zr=!0,this.sn=.1,this.en=o.r.Pixelated,this.hn=()=>{this.Fr.forEach(((t,e)=>{t.filter.copy(this.aa)}))},this.aa=new a.c(this.hn),this.Sr=[],this.zr=!1}start(){this.zr=!0;const t=this.Sr;for(let e=0;e<t.length;++e)t[e]();this.Sr.length=0}rn(){this.Fr.forEach(((t,e)=>{const i=this.nn(e)*this.Yr*this.Kr,s=this.on(e)*this.Yr*this.Nr;t.gameObject.transform.localPosition.set(i,s,0)}))}nn(t){return parseInt(t.substring(0,t.indexOf("_")))}on(t){return parseInt(t.substring(t.indexOf("_")+1))}ln(t,e){return`${t}_${e}`}cn(t,e,i,s){const r=i-t*this.Yr+this.Yr/2,n=s-e*this.Yr+this.Yr/2;return new h.F(r,n)}an(t,e){const i=this.ln(t,e);let h=this.Fr.get(i);if(void 0===h){const n=new s.s;this.gameObject.addChildFromBuilder(this.engine.instantiater.buildGameObject("css_tilemap_renderer_"+t+"_"+e,new r.P(t*this.Yr*this.Kr,e*this.Yr*this.Nr,0),void 0,(new r.P).setScalar(this.Jr)).withComponent(l.N,(t=>{this.Qr&&(t.imageSources=this.Qr),t.gridCellWidth=this.Kr,t.gridCellHeight=this.Nr,t.tileResolutionX=this.Br,t.tileResolutionY=this.Gr,t.rowCount=this.Yr,t.columnCount=this.Yr,t.pointerEvents=this.Zr,t.viewScale=this.sn,t.filter.copy(this.aa)})).getComponent(l.N,n)),h=n.ref,this.Fr.set(i,h)}return h}un(t,e){const i=this.ln(t,e),s=this.Fr.get(i);return void 0===s?null:s}drawTile(t,e,i,s){if(!this.zr)return void this.Sr.push((()=>{this.drawTile(t,e,i,s)}));const h=Math.floor((t+this.Yr/2)/this.Yr),r=Math.floor((e+this.Yr/2)/this.Yr),n=this.an(h,r),o=this.cn(h,r,t,e),l=this.chunkSize%2==0?0:-.5,a=this.chunkSize%2==0?0:.5,c=o.x+l,m=this.Yr-o.y-1+a;n.drawTile(c,m,i,s);const u=this.ln(h,r),d=this.Xr.get(u);void 0===d?this.Xr.set(u,new Set([`${c}_${m}`])):d.add(`${c}_${m}`)}drawTileFromTwoDimensionalArray(t,e,i){if(this.zr)for(let s=0;s<t.length;s++)for(let h=0;h<t[s].length;h++)null!==t[s][h]&&this.drawTile(h+e,t.length-s+i-1,t[s][h].i,t[s][h].a);else this.Sr.push((()=>{this.drawTileFromTwoDimensionalArray(t,e,i)}))}clearTile(t,e){if(!this.zr)return void this.Sr.push((()=>{this.clearTile(t,e)}));const i=Math.floor((t+this.Yr/2)/this.Yr),s=Math.floor((e+this.Yr/2)/this.Yr),h=this.un(i,s);if(null===h)return;const r=this.cn(i,s,t,e),n=this.chunkSize%2==0?0:-.5,o=this.chunkSize%2==0?0:.5,l=r.x+n,a=this.Yr-r.y-1+o;h.clearTile(l,a);const c=this.ln(i,s),m=this.Xr.get(c);void 0!==m&&(m.delete(`${l}_${a}`),0===m.size&&(this.Xr.delete(c),this.Fr.delete(c),h.destroy()))}get chunkSize(){return this.Yr}set chunkSize(t){this.Yr=t,this.rn(),this.Fr.forEach(((t,e)=>{t.rowCount=this.Yr,t.columnCount=this.Yr}))}set imageSources(t){this.zr?(this.Qr=t,this.Fr.forEach(((e,i)=>{e.imageSources=t}))):this.Sr.push((()=>{this.imageSources=t}))}get pointerEvents(){return this.Zr}set pointerEvents(t){this.Zr=t,this.Fr.forEach(((e,i)=>{e.pointerEvents=t}))}get gridCellWidth(){return this.Kr}set gridCellWidth(t){this.Kr!==t&&(this.Kr=t,this.rn(),this.Fr.forEach(((t,e)=>{t.gridCellWidth=this.Kr})))}get gridCellHeight(){return this.Nr}set gridCellHeight(t){this.Nr!==t&&(this.Nr=t,this.rn(),this.Fr.forEach(((t,e)=>{t.gridCellHeight=this.Nr})))}get tileResolutionX(){return this.Br}set tileResolutionX(t){this.Br!==t&&(this.Br=t,this.Fr.forEach(((t,e)=>{t.tileResolutionX=this.Br})))}get tileResolutionY(){return this.Gr}set tileResolutionY(t){this.Gr!==t&&(this.Gr=t,this.Fr.forEach(((t,e)=>{t.tileResolutionY=this.Gr})))}get tilemapScale(){return this.Jr}set tilemapScale(t){this.Jr!==t&&(this.Jr=t,this.Fr.forEach(((t,e)=>{t.gameObject.transform.localScale.setScalar(this.Jr)})))}get gridCenter(){const t=this.Yr%2==1?0:this.Kr/2,e=this.Yr%2==1?0:this.Nr/2;return new h.F(this.transform.localPosition.x+t,this.transform.localPosition.y+e)}get gridCenterX(){const t=this.Yr%2==1?0:this.Kr/2;return this.transform.localPosition.x+t}get gridCenterY(){const t=this.Yr%2==1?0:this.Nr/2;return this.transform.localPosition.y+t}get viewScale(){return this.sn}set viewScale(t){this.sn=t,this.Fr.forEach(((t,e)=>{t.viewScale=this.sn}))}get filter(){return this.aa}get imageRenderingMode(){return this.en}set imageRenderingMode(t){this.en=t,this.Fr.forEach(((e,i)=>{e.imageRenderingMode=t}))}}},6987:(t,e,i)=>{i.d(e,{N:()=>h});var s=i(1169);class h extends s.C{constructor(){super(...arguments),this.disallowMultipleComponent=!0,this.qa=-100}update(){this.transform.localPosition.z=this.engine.cameraContainer.camera.transform.position.z+this.qa}get offset(){return this.qa}set offset(t){this.qa=t}}},4669:(t,e,i)=>{i.d(e,{I:()=>o,N:()=>l});var s=i(6120),h=i(9387),r=i(9429),n=i(6324);class o{constructor(t,e=1,i=1){if(!t.complete)throw new Error(`Image {${t.src}} is not loaded.`);this.lc=t,this.Aa=i,this.wa=e}get htmlImageElement(){return this.lc}get columnCount(){return this.wa}get rowCount(){return this.Aa}}class l extends r.Y{constructor(){super(...arguments),this.wa=10,this.Aa=10,this.Kr=1,this.Nr=1,this.Br=16,this.Gr=16,this.Qr=null,this.en=n.r.Pixelated,this.Sr=[]}renderInitialize(){this.uc();const t=this.Sr;for(let e=0;e<t.length;++e)t[e]();this.Sr.length=0}updateCenterOffset(t){if(!this.css3DObject)return;const e=this.wa*this.Kr,i=this.Aa*this.Nr;this.css3DObject.position.set(e*this.centerOffset.x,i*this.centerOffset.y,0),t&&(h.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject))}updateViewScale(t){if(!this.css3DObject)return;const e=this.viewScale,i=this.htmlElement,s=this.wa*this.Kr,r=this.Aa*this.Nr;i.style.width=s/e+"px",i.style.height=r/e+"px",this.css3DObject.scale.set(e,e,e),t&&(h.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject))}uc(){const t=this.wa*this.Kr,e=this.Aa*this.Nr,i=this.wa*this.Br,s=this.Aa*this.Gr;this.htmlElement=document.createElement("canvas"),this.htmlElement.width=i,this.htmlElement.height=s,this.htmlElement.style.imageRendering=this.en,this.htmlElement.style.width=t/this.viewScale+"px",this.htmlElement.style.height=e/this.viewScale+"px";const r=this.initializeBaseComponents(!1);h.w.updateRawObject3DWorldMatrixRecursively(r),this.transform.enqueueRenderAttachedObject3D(r)}drawTile(t,e,i,s){if(!this.readyToDraw)return void this.Sr.push((()=>this.drawTile(t,e,i,s)));const h=this.htmlElement.getContext("2d"),r=this.Qr[i];if(1===r.rowCount&&1===r.columnCount)h.drawImage(r.htmlImageElement,0,0,this.Br,this.Gr,t*this.Br,e*this.Gr,this.Br,this.Gr);else{if(void 0===s)throw new Error("Atlas index is required.");{const i=Math.floor(s/r.columnCount),n=s%r.columnCount,o=r.htmlImageElement.width/r.columnCount,l=r.htmlImageElement.height/r.rowCount;h.drawImage(r.htmlImageElement,n*o,i*l,o,l,t*this.Br,e*this.Gr,this.Br,this.Gr)}}}drawTileFromTwoDimensionalArray(t,e,i){if(!this.readyToDraw)return void this.Sr.push((()=>this.drawTileFromTwoDimensionalArray(t,e,i)));const s=this.htmlElement.getContext("2d");for(let h=0;h<t.length;h++){const r=t[h];for(let t=0;t<r.length;t++){const n=r[t];if(null===n)continue;const o=this.Qr[n.i];if(1===o.rowCount&&1===o.columnCount)s.drawImage(o.htmlImageElement,0,0,this.Br,this.Gr,t*this.Br+e*this.Br,h*this.Gr+i*this.Gr,this.Br,this.Gr);else{if(void 0===n.a)throw new Error("Atlas index is required.");{const r=n.a%o.columnCount,l=Math.floor(n.a/o.columnCount),a=o.htmlImageElement.width/o.columnCount,c=o.htmlImageElement.height/o.rowCount;s.drawImage(o.htmlImageElement,r*a,l*c,a,c,t*this.Br+e*this.Br,h*this.Gr+i*this.Gr,this.Br,this.Gr)}}}}}clearTile(t,e){if(!this.readyToDraw)return void this.Sr.push((()=>this.clearTile(t,e)));this.htmlElement.getContext("2d").clearRect(t*this.Br,e*this.Gr,this.Br,this.Gr)}set imageSources(t){if(this.readyToDraw){this.Qr=t;for(let e=0;e<t.length;++e)if(!t[e].htmlImageElement.complete)throw new Error(`Image ${t[e].htmlImageElement.src} is not loaded.`)}else this.Sr.push((()=>this.imageSources=t))}get columnCount(){return this.wa}set columnCount(t){if(this.wa=t,this.htmlElement){const t=this.wa*this.Kr,e=this.wa*this.Br;this.htmlElement.width=e,this.htmlElement.style.width=t/this.viewScale+"px",this.updateCenterOffset(!0)}}get rowCount(){return this.Aa}set rowCount(t){if(this.Aa=t,this.htmlElement){const t=this.Aa*this.Nr,e=this.Aa*this.Gr;this.htmlElement.height=e,this.htmlElement.style.height=t/this.viewScale+"px",this.updateCenterOffset(!0)}}get gridCellWidth(){return this.Kr}set gridCellWidth(t){if(this.Kr=t,this.htmlElement){const t=this.wa*this.Kr;this.htmlElement.style.width=t/this.viewScale+"px",this.updateCenterOffset(!0)}}get gridCellHeight(){return this.Nr}set gridCellHeight(t){if(this.Nr=t,this.htmlElement){const t=this.Aa*this.Nr;this.htmlElement.style.height=t/this.viewScale+"px",this.updateCenterOffset(!0)}}get tileResolutionX(){return this.Br}set tileResolutionX(t){if(this.Br=t,this.htmlElement){const t=this.wa*this.Br;this.htmlElement.width=t}}get tileResolutionY(){return this.Gr}set tileResolutionY(t){if(this.Gr=t,this.htmlElement){const t=this.Aa*this.Gr;this.htmlElement.height=t}}get gridCenter(){const t=this.columnCount%2==1?0:this.Kr/2,e=this.rowCount%2==1?0:this.Nr/2;return new s.F(this.transform.position.x+t,this.transform.position.y+e)}get gridCenterX(){return this.transform.position.x+(this.columnCount%2==1?0:this.Kr/2)}get gridCenterY(){return this.transform.position.y+(this.rowCount%2==1?0:this.Nr/2)}get imageRenderingMode(){return this.en}set imageRenderingMode(t){this.en=t,this.htmlElement&&(this.htmlElement.style.imageRendering=this.en)}}},1169:(t,e,i)=>{i.d(e,{C:()=>h});var s=i(8172);class h extends s.w{}}}]);