"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[666],{9596:(t,e,s)=>{s.d(e,{X:()=>r});var i=s(3674),h=s(2441),n=s(9760),a=s(6120),l=s(4532);class r extends i.w{constructor(){super(...arguments),this.column=18,this.row=13}awake(){for(let t=0;t<this.row;t++)for(let e=0;e<this.column;e++)this.spawnText(new a.F(e+.5,this.row-1-t),t*this.column+e)}spawnText(t,e){this.engine.scene.addChildFromBuilder(this.engine.instantiater.buildGameObject("text",new l.P(t.x,t.y,10)).withComponent(h.Km,(t=>{t.text=e.toString(),t.textColor=new n.I(0,0,0),t.viewScale=.05})))}}},5093:(t,e,s)=>{s.r(e),s.d(e,{assets:()=>x,contentTitle:()=>O,default:()=>D,frontMatter:()=>y,metadata:()=>j,toc:()=>v});var i=s(7462),h=(s(7294),s(3905)),n=s(5853),a=s(708),l=s(4483),r=s(6896),o=s(1269),c=s(6885),d=s(8788),m=s(4532),p=s(6120),u=s(9484),w=s(9596);class g extends a.A{run(){const t=this.instantiater;return this.sceneBuilder.withChild(t.buildGameObject("test-sprite-atlas").withComponent(l.$,(t=>{t.asyncSetImageFromPath(u.Z,18,13),t.imageWidth=1,t.imageHeight=1,t.viewScale=1}))).withChild(t.buildGameObject("camera").withComponent(r.V,(t=>{t.viewSize=1})).withComponent(o.Y,(t=>{t.mouseMoveButton=0})).withComponent(c.y,(t=>{t.renderWidth=50,t.renderHeight=50})))}}class f extends a.A{run(){const t=this.instantiater;return this.sceneBuilder.withChild(t.buildGameObject("test-sprite-atlas").active(!1).withComponent(l.$,(t=>{t.asyncSetImageFromPath(u.Z,18,13),t.imageWidth=1,t.imageHeight=1,t.viewScale=1}))).withChild(t.buildGameObject("draw-index").withComponent(w.X)).withChild(t.buildGameObject("camera").withComponent(r.V,(t=>{t.viewSize=4})).withComponent(o.Y,(t=>{t.mouseMoveButton=0,t.maxViewSize=4})).withComponent(c.y,(t=>{t.renderWidth=50,t.renderHeight=50})))}}class b extends a.A{run(){const t=this.instantiater;return this.sceneBuilder.withChild(t.buildGameObject("test-sprite-atlas").active(!1).withComponent(l.$,(t=>{t.asyncSetImageFromPath(u.Z,18,13),t.imageWidth=1,t.imageHeight=1,t.viewScale=1}))).withChild(t.buildGameObject("draw-index").withComponent(w.X)).withChild(t.buildGameObject("overworld-tileset",new m.P(-.5,-.5,0)).withComponent(d._,(t=>{t.asyncSetImageFromPath(u.Z),t.centerOffset=new p.F(.5,.5),t.imageWidth=18,t.imageHeight=13}))).withChild(t.buildGameObject("camera").withComponent(r.V,(t=>{t.viewSize=4})).withComponent(o.Y,(t=>{t.mouseMoveButton=0,t.maxViewSize=4})).withComponent(c.y,(t=>{t.renderWidth=50,t.renderHeight=50})))}}const y={},O="Sprite Atlas Setup",j={unversionedId:"tutorial-2dtopdown/sprite-atlas-setup",id:"tutorial-2dtopdown/sprite-atlas-setup",title:"Sprite Atlas Setup",description:"Sprite Atlas can be used right away to reduce the load time of the game and make the game easier to manage.",source:"@site/docs/2-tutorial-2dtopdown/3-sprite-atlas-setup.mdx",sourceDirName:"2-tutorial-2dtopdown",slug:"/tutorial-2dtopdown/sprite-atlas-setup",permalink:"/the-world-engine.ts/build/docs/tutorial-2dtopdown/sprite-atlas-setup",draft:!1,editUrl:"https://github.com/The-World-Space/the-world-engine.ts/tree/main/docs/docusaurus/docs/2-tutorial-2dtopdown/3-sprite-atlas-setup.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Editor Setup",permalink:"/the-world-engine.ts/build/docs/tutorial-2dtopdown/editor-setup"},next:{title:"Tilemap Basic",permalink:"/the-world-engine.ts/build/docs/tutorial-2dtopdown/tilemap-basic"}},x={},v=[{value:"Donload Sprite Atlas",id:"donload-sprite-atlas",level:2},{value:"Indexing Sprite Atlas",id:"indexing-sprite-atlas",level:2},{value:"Use <code>CssSpriteAtlasRenderer</code>",id:"use-cssspriteatlasrenderer",level:3},{value:"Draw ImageIndex",id:"draw-imageindex",level:3}],S={toc:v};function D(t){let{components:e,...a}=t;return(0,h.kt)("wrapper",(0,i.Z)({},S,a,{components:e,mdxType:"MDXLayout"}),(0,h.kt)("h1",{id:"sprite-atlas-setup"},"Sprite Atlas Setup"),(0,h.kt)("p",null,"Sprite Atlas can be used right away to reduce the load time of the game and make the game easier to manage."),(0,h.kt)("p",null,"we will download Sprite Atlas and prepare for use."),(0,h.kt)("h2",{id:"donload-sprite-atlas"},"Donload Sprite Atlas"),(0,h.kt)("p",null,"First, ",(0,h.kt)("strong",{parentName:"p"},"download the game assets")," that we will use. "),(0,h.kt)("p",null,"We're going to use the ",(0,h.kt)("a",{parentName:"p",href:"https://o-lobster.itch.io/adventure-pack"},"TOP-DOWN Adventure Pack")," But there's a slight flaw in the original,\nso We'll use the revised version"),(0,h.kt)("p",null,"you can ",(0,h.kt)("strong",{parentName:"p"},"download")," the revised version from the\n",(0,h.kt)("strong",{parentName:"p"},(0,h.kt)("a",{parentName:"strong",href:"https://download-directory.github.io/?url=https%3A%2F%2Fgithub.com%2FThe-World-Space%2Fthe-world-engine-examples%2Ftree%2Fmain%2Ftopdown2d%2Fsrc%2Fasset%2Fimage"},"here")),"."),(0,h.kt)("p",null,"put the contents of the downloaded folder into the src/asset/image of the project."),(0,h.kt)("p",null,(0,h.kt)("img",{alt:"Overworld_Tileset.png",src:s(6426).Z,width:"288",height:"208"})),(0,h.kt)("p",null,"We will try level design using ",(0,h.kt)("inlineCode",{parentName:"p"},"Overworld_Tileset.png")," among the downloaded files."),(0,h.kt)("p",null,(0,h.kt)("img",{alt:"Char_Sprites/char_spritesheet.png",src:s(564).Z,width:"416",height:"368"})),(0,h.kt)("p",null,"And we will make a player with ",(0,h.kt)("inlineCode",{parentName:"p"},"Char_Sprites/char_spritesheet.png"),"."),(0,h.kt)("h2",{id:"indexing-sprite-atlas"},"Indexing Sprite Atlas"),(0,h.kt)("p",null,"Like the picture above, the image made by combining various images is called Sprite Atlas."),(0,h.kt)("p",null,"We're going to cut and use only the parts we want over there."),(0,h.kt)("p",null,(0,h.kt)("strong",{parentName:"p"},"The following considerations should be taken")," to properly cut the image:"),(0,h.kt)("ul",null,(0,h.kt)("li",{parentName:"ul"},"row count and column count of the image"),(0,h.kt)("li",{parentName:"ul"},"image should not have inconsistent size"),(0,h.kt)("li",{parentName:"ul"},"image should not have inconsistent padding"),(0,h.kt)("li",{parentName:"ul"},"you must know the index of the image you want to use")),(0,h.kt)("p",null,"For example, ",(0,h.kt)("strong",{parentName:"p"},(0,h.kt)("inlineCode",{parentName:"strong"},"Overworld_Tileset")," image has row count of 13 and column count of 18"),"."),(0,h.kt)("p",null,"Then, let's render the image with ",(0,h.kt)("inlineCode",{parentName:"p"},"Overworld_Tileset.png"),"."),(0,h.kt)("h3",{id:"use-cssspriteatlasrenderer"},"Use ",(0,h.kt)("inlineCode",{parentName:"h3"},"CssSpriteAtlasRenderer")),(0,h.kt)("p",null,"Load the image with proper row and column count."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/asset/Bootstrapper.ts"',title:'"src/asset/Bootstrapper.ts"'},'import OverworldTileset from "./image/Overworld_Tileset.png";\n//...\n.withChild(instantiater.buildGameObject("test-sprite-atlas")\n    .withComponent(CssSpriteAtlasRenderer, c => {\n        c.asyncSetImageFromPath(OverworldTileset, 18, 13);\n        c.imageWidth = 1;\n        c.imageHeight = 1;\n        c.viewScale = 1;\n    }))\n    \n.withChild(instantiater.buildGameObject("camera")\n//...\n')),(0,h.kt)(n.Z,{bootstrapper:g,ignoreEvents:!0,mdxType:"DocumentGame"}),(0,h.kt)("p",null,"The top leftmost tile of the Sprite Atlas was rendered."),(0,h.kt)("p",null,"Sprite Atlas has a property called imageIndex, which, as the value increases,\nselects tiles to render from left to right, top to bottom."),(0,h.kt)("p",null,"So ",(0,h.kt)("strong",{parentName:"p"},"we need to indexing the image to choose which tiles to use"),"."),(0,h.kt)("h3",{id:"draw-imageindex"},"Draw ImageIndex"),(0,h.kt)("p",null,"Let's try scripting the index drawing."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/asset/script/DrawIndex.ts"',title:'"src/asset/script/DrawIndex.ts"'},'import { Color, Component, CssTextRenderer } from "the-world-engine";\nimport { Vector2, Vector3 } from "three/src/Three";\n\nexport class DrawIndex extends Component {\n    public column = 18;\n    public row = 13;\n\n    public awake(): void {\n        for (let i = 0; i < this.row; i++) {\n            for (let j = 0; j < this.column; j++) {\n                this.spawnText(new Vector2(j + 0.5, this.row - 1 - i), i * this.column + j);\n            }\n        }\n    }\n\n    private spawnText(pos: Vector2, index: number): void {\n        this.engine.scene.addChildFromBuilder(\n            this.engine.instantiater.buildGameObject("text", new Vector3(pos.x, pos.y, 10))\n                .withComponent(CssTextRenderer, c => {\n                    c.text = index.toString();\n                    c.textColor = new Color(0, 0, 0);\n                    c.viewScale = 0.05;\n                })\n        );\n    }\n}\n')),(0,h.kt)("p",null,"to use simple for loop to spawn text."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/asset/Bootstrapper.ts"',title:'"src/asset/Bootstrapper.ts"'},'.withChild(instantiater.buildGameObject("test-sprite-atlas")\n    .active(false) //disable the sprite atlas renderer for now\n    .withComponent(CssSpriteAtlasRenderer, c => {\n        //...\n    }))\n\n.withChild(instantiater.buildGameObject("draw-index")\n    .withComponent(DrawIndex))\n')),(0,h.kt)("p",null,"Let's add it to the world and deactivate the test-sprite-atlas for a while"),(0,h.kt)(n.Z,{bootstrapper:f,ignoreEvents:!0,mdxType:"DocumentGame"}),(0,h.kt)("p",null,"You can see that the index was spawned."),(0,h.kt)("p",null,"Now let's superimpose the image below."),(0,h.kt)("pre",null,(0,h.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/asset/Bootstrapper.ts"',title:'"src/asset/Bootstrapper.ts"'},'.withChild(instantiater.buildGameObject("draw-index")\n    .withComponent(DrawIndex))\n\n// added\n.withChild(instantiater.buildGameObject("overworld-tileset", new Vector3(-0.5, -0.5, 0))\n    .withComponent(CssSpriteRenderer, c => {\n        c.asyncSetImageFromPath(OverworldTileset);\n        c.centerOffset = new Vector2(0.5, 0.5);\n        c.imageWidth = 18;\n        c.imageHeight = 13;\n    }))\n')),(0,h.kt)(n.Z,{bootstrapper:b,mdxType:"DocumentGame"}),(0,h.kt)("p",null,"now we know imageIndices."),(0,h.kt)("p",null,"Once you draw an image index like this, you can easily find the index you want."))}D.isMDXComponent=!0},7888:(t,e,s)=>{s.d(e,{s:()=>i});class i{constructor(t=null){this.ref=t}}},1269:(t,e,s)=>{s.d(e,{Y:()=>l});var i=s(6120),h=s(4532),n=s(3674),a=s(6896);class l extends n.w{constructor(){super(...arguments),this.disallowMultipleComponent=!0,this.requiredComponents=[a.V],this.mh=null,this.Vh=!1,this.wh=1,this.zh=new i.F,this.xh=1,this.Sh=10,this.bh=5,this._h=5,this.Bh=new h.P,this.Eh=t=>{" "===t.key&&(this._h=this.bh,this.Mh(),this.transform.localPosition.copy(this.Bh))},this.jh=t=>{this._h+=.01*t.deltaY,this._h<this.xh?this._h=this.xh:this._h>this.Sh&&(this._h=this.Sh),this.Mh()},this.Cr=t=>{this.zh.set(t.clientX/this.engine.screen.width,t.clientY/this.engine.screen.height),t.button===this.wh&&(this.Vh=!0)},this.kh=t=>{t.button===this.wh&&(this.Vh=!1)},this.yh=t=>{if(!this.Vh)return;const e=t.clientX/this.engine.screen.width,s=t.clientY/this.engine.screen.height,i=e-this.zh.x,h=s-this.zh.y,n=this.engine.screen.width/this.engine.screen.height;this.transform.localPosition.x-=i*this.mh.viewSize*2*n,this.transform.localPosition.y+=h*this.mh.viewSize*2,this.zh.set(e,s)},this.Dh=t=>{this.Vh=!1}}awake(){this.mh=this.gameObject.getComponent(a.V),this.bh=this.mh.viewSize,this.Bh.copy(this.transform.localPosition),this._h=this.bh,this.mh.viewSize=this._h}onEnable(){const t=this.engine.input;t.onKeyDown.addListener(this.Eh),t.onWheel.addListener(this.jh),t.onPointerDown.addListener(this.Cr),t.onPointerUp.addListener(this.kh),t.onPointerMove.addListener(this.yh),t.onPointerLeave.addListener(this.Dh)}onDisable(){const t=this.engine.input;t.onKeyDown.removeListener(this.Eh),t.onWheel.removeListener(this.jh),t.onPointerDown.removeListener(this.Cr),t.onPointerUp.removeListener(this.kh),t.onPointerMove.removeListener(this.yh),t.onPointerLeave.removeListener(this.Dh)}Mh(){this.mh&&(this.mh.viewSize=this._h)}get minViewSize(){return this.xh}set minViewSize(t){this.xh=t,this._h<this.xh&&(this._h=this.xh,this.Mh())}get maxViewSize(){return this.Sh}set maxViewSize(t){this.Sh=t,this._h>this.Sh&&(this._h=this.Sh,this.Mh())}get mouseMoveButton(){return this.wh}set mouseMoveButton(t){this.wh=t}}},6885:(t,e,s)=>{s.d(e,{y:()=>r});var i=s(4532),h=s(3674),n=s(7888),a=s(6896),l=s(1466);class r extends h.w{constructor(){super(...arguments),this.disallowMultipleComponent=!0,this.requiredComponents=[a.V],this.hd=null,this.rd=null,this.Ih=1,this.Th=1,this.nd=18,this.od=10,this.dd=.2,this.ad=0,this.ld=new i.P(NaN,NaN,NaN)}awake(){const t=new n.s;this.rd=this.engine.scene.addChildFromBuilder(this.engine.instantiater.buildGameObject("grid-renderer",void 0,void 0,new i.P(this.dd,this.dd,this.dd)).active(!1).withComponent(l.w,(t=>{const e=document.createElement("div");e.style.backgroundImage="                        repeating-linear-gradient(#999 0 1px, transparent 1px 100%),                        repeating-linear-gradient(90deg, #999 0 1px, transparent 1px 100%)",e.style.backgroundSize=this.Ih/this.dd/.1+"px "+this.Th/this.dd/.1+"px",t.elementWidth=this.nd/this.dd,t.elementHeight=this.od/this.dd,t.pointerEvents=!1,t.element=e,t.viewScale=.1})).getComponent(l.w,t)),this.hd=t.ref}onEnable(){this.rd.exists&&(this.rd.activeSelf=!0)}onDisable(){this.rd.exists&&(this.rd.activeSelf=!1)}update(){const t=this.transform.position,e=1/this.dd/.1,s=this.nd*e/2,i=this.od*e/2,h=this.Ih*e,n=this.Th*e,a=s%h,l=i%n;if(!t.equals(this.ld)){const s=this.rd.transform.position;s.copy(t),s.z+=this.ad,this.hd.element.style.backgroundPosition=-t.x*e+a+h/2-.5+"px "+(t.y*e+l+n/2-.5)+"px"}}onDestroy(){var t;null===(t=this.rd)||void 0===t||t.destroy()}fd(){const t=this.hd;t&&(t.element.style.backgroundSize=this.Ih/this.dd/.1+"px "+this.Th/this.dd/.1+"px")}get gridCellWidth(){return this.Ih}set gridCellWidth(t){this.Ih=t,this.fd()}get gridCellHeight(){return this.Th}set gridCellHeight(t){this.Th=t,this.fd()}get renderWidth(){return this.nd}set renderWidth(t){this.nd=t,this.hd&&(this.hd.elementWidth=this.nd/this.dd)}get renderHeight(){return this.od}set renderHeight(t){this.od=t,this.hd&&(this.hd.elementHeight=this.od/this.dd)}get lineWidth(){return.1*this.dd}set lineWidth(t){this.dd=t/.1;const e=this.hd;e&&(this.fd(),e.elementWidth=this.nd/this.dd,e.elementHeight=this.od/this.dd,e.gameObject.transform.localScale.setScalar(this.dd))}get zOffset(){return this.ad}set zOffset(t){this.ad=t}}},1466:(t,e,s)=>{s.d(e,{w:()=>n});var i=s(4627),h=s(6924);class n extends h.Y{constructor(){super(...arguments),this.tu=1,this.su=1,this.iu=!1,this.Ca=null}renderInitialize(){var t;null===(t=this.Ca)||void 0===t||t.call(this),this.htmlElement||(this.element=null)}updateCenterOffset(t){if(!this.css3DObject)return;let e,s;if(this.iu)if(this.css3DObject.element.parentElement){const t=this.css3DObject.element.style.display;this.css3DObject.element.style.display="",e=this.css3DObject.element.offsetWidth*this.viewScale,s=this.css3DObject.element.offsetHeight*this.viewScale,this.css3DObject.element.style.display=t}else{const t=this.css3DObject.element.style.display;this.css3DObject.element.style.display="";const i=this.css3DObject.element.style.transform;this.css3DObject.element.style.transform="translateX(1000000px)",document.body.appendChild(this.css3DObject.element),e=this.css3DObject.element.offsetWidth*this.viewScale,s=this.css3DObject.element.offsetHeight*this.viewScale,this.css3DObject.element.style.display=t,this.css3DObject.element.style.transform=i,document.body.removeChild(this.css3DObject.element)}else e=this.tu,s=this.su;this.css3DObject.position.set(e*this.centerOffset.x,s*this.centerOffset.y,0),t&&(i.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject))}updateViewScale(t){if(!this.css3DObject)return;const e=this.viewScale;this.iu?(this.css3DObject.scale.set(e,e,e),this.updateCenterOffset(!1)):(this.css3DObject.element.style.width=this.tu/this.viewScale+"px",this.css3DObject.element.style.height=this.su/this.viewScale+"px",this.css3DObject.scale.set(e,e,e)),t&&(i.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject))}get element(){return this.htmlElement}set element(t){const e=this.htmlElement=null!=t?t:document.createElement("div");this.readyToDraw?this.hu(e):this.Ca=()=>this.hu(e)}hu(t){this.iu?(t.style.width="auto",t.style.height="auto"):(t.style.width=this.tu/this.viewScale+"px",t.style.height=this.su/this.viewScale+"px");const e=this.initializeBaseComponents(!0);i.w.updateRawObject3DWorldMatrixRecursively(e),this.transform.enqueueRenderAttachedObject3D(e)}get elementWidth(){if(this.iu){if(this.htmlElement){const t=this.htmlElement.style.display;this.htmlElement.style.display="";const e=this.htmlElement.offsetWidth*this.viewScale;return this.htmlElement.style.display=t,e}return 0}return this.tu}set elementWidth(t){this.iu||(this.tu=t,this.htmlElement&&(this.htmlElement.style.width=t/this.viewScale+"px"),this.updateCenterOffset(!0))}get elementHeight(){if(this.iu){if(this.htmlElement){const t=this.htmlElement.style.display;this.htmlElement.style.display="";const e=this.htmlElement.offsetHeight*this.viewScale;return this.htmlElement.style.display=t,e}return 0}return this.su}set elementHeight(t){this.iu||(this.su=t,this.htmlElement&&(this.htmlElement.style.height=t/this.viewScale+"px"),this.updateCenterOffset(!0))}get autoSize(){return this.iu}set autoSize(t){this.iu=t,this.htmlElement&&(t?(this.htmlElement.style.width="auto",this.htmlElement.style.height="auto"):(this.htmlElement.style.width=this.tu/this.viewScale+"px",this.htmlElement.style.height=this.su/this.viewScale+"px"))}}},4483:(t,e,s)=>{s.d(e,{$:()=>o});var i,h,n=s(3367),a=s(4627),l=s(6924),r=s(8788);(h=i||(i={}))[h.ObjectFit=0]="ObjectFit",h[h.ClipPath=1]="ClipPath";class o extends l.Y{constructor(){super(...arguments),this.Aa=i.ObjectFit,this.Ia=0,this.ja=0,this.Ga=!1,this.Ha=!1,this.Wa=1,this.an=r.r.Pixelated,this.pa=1,this.Sa=1,this.Xa=0,this.Ya=0,this.za=0,this.Ca=null}renderInitialize(){this.Ca?this.Ca():this.asyncSetImageFromPath(n.Q.defaultSpriteSrc,1,1)}updateCenterOffset(t){if(this.css3DObject)if(this.Aa===i.ObjectFit)this.css3DObject.position.set(this.Ia*this.centerOffset.x,this.ja*this.centerOffset.y,0),t&&(a.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject));else{const e=this.Xa%this.pa,s=Math.floor(this.Xa/this.pa),i=this.Ga?-(this.Ia*this.pa/2-this.Ia/2)+e*this.Ia:this.Ia*this.pa/2-this.Ia/2-e*this.Ia,h=this.Ha?this.ja*this.Sa/2-this.ja/2-s*this.ja:-(this.ja*this.Sa/2-this.ja/2)+s*this.ja;this.css3DObject.position.set(this.Ia*this.centerOffset.x+i,this.ja*this.centerOffset.y+h,0),t&&(a.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject))}}updateViewScale(t){if(this.css3DObject)if(this.Aa===i.ObjectFit){const e=this.viewScale,s=this.Ga?-1:1,i=this.Ha?-1:1;this.css3DObject.scale.set(this.Ia/this.Ya*e*s,this.ja/this.za*e*i,1),t&&(a.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject))}else{const e=this.viewScale,s=this.htmlElement;s.style.width=this.Ia*this.pa/e+"px",s.style.height=this.ja*this.Sa/e+"px";const i=this.Ga?-1:1,h=this.Ha?-1:1;this.css3DObject.scale.set(e*i,e*h,e),t&&(a.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject))}}Ea(){if(this.htmlElement)if(this.Aa===i.ObjectFit){const t=-this.Xa%this.pa*this.Ya,e=-Math.floor(this.Xa/this.pa)*this.za;this.htmlElement.style.objectPosition=t+"px "+e+"px"}else{const t=Math.floor(this.Xa/this.pa),e=this.pa-this.Xa%this.pa-1;this.htmlElement.style.clipPath="inset("+100/this.Sa*t+"% "+100/this.pa*e+"% "+(100-(100/this.Sa*t+100/this.Sa))+"% "+(100-(100/this.pa*e+100/this.pa))+"%)"}}get image(){return this.htmlElement}asyncSetImageFromPath(t,e,s,i){var h;if(!this.readyToDraw)return void(this.Ca=()=>this.asyncSetImageFromPath(t,e,s,i));const n=null!==(h=this.htmlElement)&&void 0!==h?h:new Image;n.src=t;const a=t=>{this.exists&&(n.removeEventListener("load",a),this.setImage(n,e,s),null==i||i())};n.addEventListener("load",a)}setImage(t,e,s){if(!t.complete)throw new Error(`Image {${t.src}} is not loaded.`);this.pa=e,this.Sa=s,this.htmlElement=t,t.alt=this.gameObject.name+"_sprite_atlas",t.style.imageRendering=this.an,t.style.opacity=this.Wa.toString(),this.Aa===i.ObjectFit?(1!==this.viewScale&&console.warn("CssSpriteAtlas.viewScale is not supported in CssSpriteAtlasRenderMode.ObjectFit, for supressing this warning set viewScale to 1."),this.Ya=t.naturalWidth/this.pa,this.za=t.naturalHeight/this.Sa,0===this.Ia&&(this.Ia=.1*this.Ya),0===this.ja&&(this.ja=.1*this.za),t.style.width=this.Ya+"px",t.style.height=this.za+"px",t.style.objectFit="none"):(0===this.Ia&&(this.Ia=t.naturalWidth/this.pa*.1),0===this.ja&&(this.ja=t.naturalHeight/this.Sa*.1),t.style.width=this.Ia*this.pa/this.viewScale+"px",t.style.height=this.ja*this.Sa/this.viewScale+"px");const h=this.initializeBaseComponents(!1);this.Ea(),a.w.updateRawObject3DWorldMatrixRecursively(h),this.transform.enqueueRenderAttachedObject3D(h)}get renderMode(){return this.Aa}set renderMode(t){if(this.Aa!==t&&(this.Aa=t,this.htmlElement)){const t=this.htmlElement;this.Aa===i.ObjectFit?(1!==this.viewScale&&console.warn("CssSpriteAtlas.viewScale is not supported in CssSpriteAtlasRenderMode.ObjectFit"),t.style.clipPath="",this.Ya=t.naturalWidth/this.pa,this.za=t.naturalHeight/this.Sa,0===this.Ia&&(this.Ia=this.Ya),0===this.ja&&(this.ja=this.za),t.style.width=this.Ya+"px",t.style.height=this.za+"px",t.style.objectFit="none"):(t.style.objectFit="",t.style.objectPosition="",0===this.Ia&&(this.Ia=t.naturalWidth/this.pa),0===this.ja&&(this.ja=t.naturalHeight/this.Sa),t.style.width=this.Ia*this.pa/this.viewScale+"px",t.style.height=this.ja*this.Sa/this.viewScale+"px"),this.updateViewScale(!1),this.updateCenterOffset(!1),this.Ea(),a.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject)}}get imageIndex(){return this.Xa}set imageIndex(t){this.Xa=t,this.Ea(),this.Aa===i.ClipPath&&this.updateCenterOffset(!0)}get columnCount(){return this.pa}get rowCount(){return this.Sa}get imageWidth(){return this.Ia}set imageWidth(t){this.Ia=t,this.Aa===i.ObjectFit?this.css3DObject&&(this.css3DObject.scale.x=this.Ia/this.Ya*this.viewScale,this.css3DObject.scale.x*=this.Ga?-1:1):this.htmlElement&&(this.htmlElement.style.width=t*this.pa/this.viewScale+"px"),this.updateCenterOffset(!0)}get imageHeight(){return this.ja}set imageHeight(t){this.ja=t,this.Aa===i.ObjectFit?this.css3DObject&&(this.css3DObject.scale.y=this.ja/this.za*this.viewScale,this.css3DObject.scale.y*=this.Ha?-1:1):this.htmlElement&&(this.htmlElement.style.height=t*this.Sa/this.viewScale+"px"),this.updateCenterOffset(!0)}get imageFlipX(){return this.Ga}set imageFlipX(t){this.Ga=t,this.css3DObject&&(this.Ga?0<this.css3DObject.scale.x&&(this.css3DObject.scale.x*=-1):this.css3DObject.scale.x<0&&(this.css3DObject.scale.x*=-1),this.Aa===i.ObjectFit?(a.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject)):(this.Ea(),this.updateCenterOffset(!0)))}get imageFlipY(){return this.Ha}set imageFlipY(t){this.Ha=t,this.css3DObject&&(this.Ha?0<this.css3DObject.scale.y&&(this.css3DObject.scale.y*=-1):this.css3DObject.scale.y<0&&(this.css3DObject.scale.y*=-1),this.Aa===i.ObjectFit?(a.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject)):(this.Ea(),this.updateCenterOffset(!0)))}get opacity(){return this.Wa}set opacity(t){this.Wa=t,this.htmlElement&&(this.htmlElement.style.opacity=this.Wa.toString())}get imageRenderingMode(){return this.an}set imageRenderingMode(t){this.an=t,this.htmlElement&&(this.htmlElement.style.imageRendering=this.an)}}},2441:(t,e,s)=>{s.d(e,{Km:()=>o,PH:()=>i});var i,h,n,a=s(4627),l=s(9760),r=s(6924);(h=i||(i={})).Left="left",h.Center="center",h.Right="right",function(t){t.Normal="normal",t.Bold="bold"}(n||(n={}));class o extends r.Y{constructor(){super(...arguments),this.tf=2,this.if=1,this.iu=!1,this.sf=8,this.hf=n.Normal,this.ef="Arial",this.rf=i.Left,this.nf=new l.I(1,1,1,1),this.ff=null,this.Ca=null}renderInitialize(){var t;null===(t=this.Ca)||void 0===t||t.call(this),this.htmlElement||(this.text=o._defaultText)}updateCenterOffset(t){if(!this.css3DObject)return;let e,s;if(this.iu)if(this.css3DObject.element.parentElement){const t=this.css3DObject.element.style.display;this.css3DObject.element.style.display="",e=this.css3DObject.element.offsetWidth*this.viewScale,s=this.css3DObject.element.offsetHeight*this.viewScale,this.css3DObject.element.style.display=t}else{const t=this.css3DObject.element.style.display;this.css3DObject.element.style.display="";const i=this.css3DObject.element.style.transform;this.css3DObject.element.style.transform="translateX(1000000px)",document.body.appendChild(this.css3DObject.element),e=this.css3DObject.element.offsetWidth*this.viewScale,s=this.css3DObject.element.offsetHeight*this.viewScale,this.css3DObject.element.style.display=t,this.css3DObject.element.style.transform=i,document.body.removeChild(this.css3DObject.element)}else e=this.tf,s=this.if;this.css3DObject.position.set(e*this.centerOffset.x,s*this.centerOffset.y,0),t&&(a.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject))}updateViewScale(t){if(!this.css3DObject)return;const e=this.viewScale;this.iu?(this.css3DObject.scale.set(e,e,e),this.updateCenterOffset(!1)):(this.css3DObject.element.style.width=this.tf/this.viewScale+"px",this.css3DObject.element.style.height=this.if/this.viewScale+"px",this.css3DObject.scale.set(e,e,e)),t&&(a.w.updateRawObject3DWorldMatrixRecursively(this.css3DObject),this.transform.enqueueRenderAttachedObject3D(this.css3DObject))}get text(){return this.ff}set text(t){this.ff=t,this.readyToDraw?this.lf(t):this.Ca=()=>this.lf(t)}lf(t){this.htmlElement||(this.htmlElement=document.createElement("div")),this.htmlElement.textContent=null!=t?t:"",this.iu?(this.htmlElement.style.width="auto",this.htmlElement.style.height="auto"):(this.htmlElement.style.width=this.tf+"px",this.htmlElement.style.height=this.if+"px"),this.htmlElement.style.fontSize=this.sf+"px",this.htmlElement.style.fontWeight=this.hf,this.htmlElement.style.fontFamily=this.ef,this.htmlElement.style.textAlign=this.rf,this.htmlElement.style.color=this.nf.toHex(),this.htmlElement.style.opacity=this.nf.a.toString();const e=this.initializeBaseComponents(!1);a.w.updateRawObject3DWorldMatrixRecursively(e),this.transform.enqueueRenderAttachedObject3D(e)}get textWidth(){if(this.iu){if(this.htmlElement){const t=this.htmlElement.style.display;this.htmlElement.style.display="";const e=this.htmlElement.offsetWidth;return this.htmlElement.style.display=t,e}return 0}return this.tf}set textWidth(t){this.iu||(this.tf=t,this.htmlElement&&(this.htmlElement.style.width=t/this.viewScale+"px"),this.updateCenterOffset(!0))}get textHeight(){if(this.iu){if(this.htmlElement){const t=this.htmlElement.style.display;this.htmlElement.style.display="";const e=this.htmlElement.offsetHeight;return this.htmlElement.style.display=t,e}return 0}return this.if}set textHeight(t){this.iu||(this.if=t,this.htmlElement&&(this.htmlElement.style.height=t/this.viewScale+"px"),this.updateCenterOffset(!0))}get autoSize(){return this.iu}set autoSize(t){this.iu=t,this.htmlElement&&(t?(this.htmlElement.style.width="auto",this.htmlElement.style.height="auto"):(this.htmlElement.style.width=this.tf/this.viewScale+"px",this.htmlElement.style.height=this.if/this.viewScale+"px"))}get fontSize(){return this.sf}set fontSize(t){this.sf=t,this.htmlElement&&(this.htmlElement.style.fontSize=t+"px")}get fontWeight(){return this.hf}set fontWeight(t){this.hf=t,this.htmlElement&&(this.htmlElement.style.fontWeight=t)}get fontFamily(){return this.ef}set fontFamily(t){this.ef=t,this.htmlElement&&(this.htmlElement.style.fontFamily=t)}get textAlign(){return this.rf}set textAlign(t){this.rf=t,this.htmlElement&&(this.htmlElement.style.textAlign=t)}get textColor(){return this.nf}set textColor(t){this.nf.copy(t),this.htmlElement&&(this.htmlElement.style.color=t.toHex(),this.htmlElement.style.opacity=t.a.toString())}}o._defaultText="Text"},9484:(t,e,s)=>{s.d(e,{Z:()=>i});const i=s.p+"assets/images/Overworld_Tileset-1c44075b314e79caada3455aa25f5809.png"},564:(t,e,s)=>{s.d(e,{Z:()=>i});const i=s.p+"assets/images/char_spritesheet-6b6a6acd99180f91c1aad1383dddc3cd.png"},6426:(t,e,s)=>{s.d(e,{Z:()=>i});const i=s.p+"assets/images/Overworld_Tileset-1c44075b314e79caada3455aa25f5809.png"}}]);